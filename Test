package com.epay.transaction.externalservice;
/*
 * Copyright (c) [2024] [State Bank of India]
 * All rights reserved.
 * <p>
 * Author:@V0000001(Shilpa Kothre)
 * Version:1.0
 */

import com.epay.transaction.client.ApiClient;
import com.epay.transaction.externalservice.request.kms.KMSAPIKeyValidationRequest;
import com.epay.transaction.externalservice.response.kms.KMSEncryptionKeysResponse;
import com.epay.transaction.model.response.TransactionResponse;
import org.springframework.core.ParameterizedTypeReference;


public class KmsServicesClient extends ApiClient {

    public static final String GET_ENCRYPTION_KEY = "/key/encryption/";
    public static final String API_KEY_VALIDATION = "/key/validated/api";

    public KmsServicesClient(String baseUrl) {
        super(baseUrl);
    }

    /**
     * It will validate the Merchant key passed in the request
     *
     * @return TransactionResponse
     */
    public TransactionResponse<String> validateAPIKeyIdAndSecret(String merchantApiKeyId, String merchantApiKeySecret) {
        return post(API_KEY_VALIDATION, KMSAPIKeyValidationRequest.builder().apiKey(merchantApiKeyId).apiKeySecret(merchantApiKeySecret).build(), new ParameterizedTypeReference<>() {});
    }


    /**
     * Get Encryption Key Request
     *
     * @param mId String
     * @return KMSEncryptionKeysResponse
     */
    public TransactionResponse<KMSEncryptionKeysResponse> getEncryptionKeys(String mId) {
        return get(GET_ENCRYPTION_KEY + mId, new ParameterizedTypeReference<>() {});
    }
}
