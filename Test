package com.sbi.epay.authentication.service;

import com.sbi.epay.authentication.exception.EPaySecurityException;
import com.sbi.epay.authentication.util.EPayAuthenticationErrorConstants;
import lombok.RequiredArgsConstructor;
import org.springframework.security.core.userdetails.UserDetailsService;
import org.springframework.stereotype.Service;

import java.text.MessageFormat;

@Service
@RequiredArgsConstructor
public class AuthenticationUserDetailsService {

    private final AuthenticationUserService userService;

    public UserDetailsService userDetailsService() {
        return username -> userService.loadUserByUserName(username).orElseThrow(() -> new EPaySecurityException(EPayAuthenticationErrorConstants.NOT_FOUND_ERROR_CODE, MessageFormat.format(EPayAuthenticationErrorConstants.NOT_FOUND_ERROR_MESSAGE, EPayAuthenticationErrorConstants.USER_NAME)));
    }
}



package com.sbi.epay.authentication.service;

import com.sbi.epay.authentication.model.EPayPrincipal;

import java.util.Optional;

/**
 * Class Name: AuthenticationUserService
 * *
 * Description: This interface contains methods getUserByUserName method .
 * *
 * Author: V1018217(Nirvay K. Bikram)
 * Copyright (c) 2024 [State Bank of India]
 * All rights reserved
 * *
 * Version:1.0
 */
public interface AuthenticationUserService {
    Optional<EPayPrincipal>  loadUserByUserName(String userName);

    boolean isTokenInValid(String token, String tokenType);
}
